{"files":[{"id":"bfb56025-e33c-4f08-ada1-821b5ed5ec1c","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Tokyo\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"d0599ed9-f283-41c0-9f8a-ca82cfd85f14","name":"address_injector","type":"server_js","source":"function mergePrint() {\n\n  //シート取得\n  var sheet \u003d SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();\n  var data \u003d sheet.getDataRange().getValues();\n\n  //プレゼンテーション指定\n  //https://docs.google.com/presentation/d/スライドのID/edit#\n  var presentation \u003d SlidesApp.openById(\u0027スライドのID\u0027);\n\n  var cnt_slide \u003d 0;\n\n  //シート2行目から1行ずつ繰り返し\n  for(var i\u003d1; i\u003cdata.length; i++){\n \n\n    //喪中等の理由で年賀状を送らない人はidを空欄にするとスキップできる\n    if(!data[i][0]){\n      ;\n    } else if(data[i][0]){\n\n      //スライドを1枚追加＆追加したページを取得\n      presentation.appendSlide();  \n      var slide \u003d presentation.getSlides()[cnt_slide];\n      cnt_slide \u003d cnt_slide + 1\n\n      //テキストボックス設置　insertShape(shapeType, left, top, width, height)\n      var zip \u003d [];\n      zip[0] \u003d slide.insertShape(SlidesApp.ShapeType.TEXT_BOX, 121,  26,  20,  30); //郵便番号\n      zip[1] \u003d slide.insertShape(SlidesApp.ShapeType.TEXT_BOX, 141,  26,  20,  30); //郵便番号\n      zip[2] \u003d slide.insertShape(SlidesApp.ShapeType.TEXT_BOX, 161,  26,  20,  30); //郵便番号\n      zip[3] \u003d slide.insertShape(SlidesApp.ShapeType.TEXT_BOX, 182,  26,  20,  30); //郵便番号\n      zip[4] \u003d slide.insertShape(SlidesApp.ShapeType.TEXT_BOX, 202,  26,  20,  30); //郵便番号\n      zip[5] \u003d slide.insertShape(SlidesApp.ShapeType.TEXT_BOX, 221,  26,  20,  30); //郵便番号\n      zip[6] \u003d slide.insertShape(SlidesApp.ShapeType.TEXT_BOX, 241,  26,  20,  30); //郵便番号\n      var addres_1 \u003d slide.insertShape(SlidesApp.ShapeType.TEXT_BOX,  25, 120, 240,  20); //住所１\n      var addres_2 \u003d slide.insertShape(SlidesApp.ShapeType.TEXT_BOX,  25, 140, 240,  20); //住所２\n      var name_1 \u003d slide.insertShape(SlidesApp.ShapeType.TEXT_BOX,   0, 190, 283,  40); //お名前\n      var name_2 \u003d slide.insertShape(SlidesApp.ShapeType.TEXT_BOX,   0, 220, 283,  40); //連名\n\n      //テキストボックスに入力\n      //郵便番号\n      for(var j\u003d0; j\u003c7; j++){\n        zip[j].getText().setText(String(data[i][1]).charAt(j)).getTextStyle().setFontFamily(\"Sawarabi Mincho\").setFontSize(20);\n      }\n\n      //住所１\n      addres_1.getText().setText(data[i][2]).getTextStyle().setFontFamily(\"Sawarabi Mincho\").setFontSize(13);\n\n      //住所２（空欄なら飛ばす）\n      if(data[i][3]){\n        addres_2.getText().setText(data[i][3]).getTextStyle().setFontFamily(\"Sawarabi Mincho\").setFontSize(13);\n      }\n\n      //お名前（太字＆中央揃え）\n      name_1.getText().setText(data[i][4] + \u0027 \u0027 + data[i][5] + \u0027 \u0027 + data[i][6]).getTextStyle().setFontFamily(\"Sawarabi Mincho\").setFontSize(25);\n      name_1.getText().getParagraphStyle().setParagraphAlignment(SlidesApp.ParagraphAlignment.CENTER);\n\n      //連名（太字＆中央揃え）\n      if(data[i][5]){\n        var space_length \u003d data[i][4].length\n        var space_zenkaku \u003d \u0027　\u0027\n        var space \u003d space_zenkaku.repeat(space_length);\n\n        name_2.getText().setText(space + \u0027 \u0027 + data[i][7]+ \u0027 \u0027 + data[i][8]).getTextStyle().setFontFamily(\"Sawarabi Mincho\").setFontSize(25);\n        name_2.getText().getParagraphStyle().setParagraphAlignment(SlidesApp.ParagraphAlignment.CENTER);\n      }\n    }\n  }   \n}\n\n\n\n\n\n\n\n\n\n\n"}]}